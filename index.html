<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRACTICE makes PERFECT!</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 16px;
        }

        .timer-display {
            background: rgba(255,255,255,0.2);
            padding: 15px 25px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 24px;
            font-weight: bold;
            letter-spacing: 2px;
        }

        .content {
            padding: 30px;
        }

        .quiz-selector {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .quiz-selector label {
            display: block;
            font-weight: 600;
            margin-bottom: 15px;
            color: #2d3748;
            font-size: 18px;
        }

        .quiz-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .quiz-btn {
            padding: 15px 20px;
            background: white;
            border: 2px solid #667eea;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            font-weight: 600;
            color: #667eea;
            text-align: center;
        }

        .quiz-btn:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .quiz-btn.active {
            background: #667eea;
            color: white;
        }

        .name-input-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .name-input-section label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: #2d3748;
        }

        .name-input-section input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .name-input-section input:focus {
            outline: none;
            border-color: #667eea;
        }

        .question-container {
            margin-bottom: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .question-number {
            color: #667eea;
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .question {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #2d3748;
        }

        .question-image {
            width: 100%;
            max-width: 500px;
            height: auto;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: block;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            padding: 15px 20px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .option:hover {
            border-color: #667eea;
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }

        .option input[type="radio"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .option label {
            cursor: pointer;
            flex: 1;
            font-size: 16px;
        }

        .text-input {
            width: 100%;
            min-height: 100px;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            resize: vertical;
            transition: border-color 0.3s;
        }

        .text-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .text-answer-label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: #2d3748;
        }

        .text-feedback {
            margin-top: 15px;
            padding: 15px;
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            border-radius: 8px;
            display: none;
        }

        .text-feedback.show {
            display: block;
        }

        .text-feedback h4 {
            color: #1976d2;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .text-feedback p {
            color: #424242;
            line-height: 1.6;
            margin: 0;
        }

        .option.correct {
            background: #d4edda;
            border-color: #28a745;
        }

        .option.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
        }

        .button-container {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        button {
            padding: 15px 30px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 150px;
        }

        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .reset-btn {
            background: #6c757d;
            color: white;
        }

        .reset-btn:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .copy-btn {
            background: #28a745;
            color: white;
        }

        .copy-btn:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .copy-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .results {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            text-align: center;
            display: none;
        }

        .results.show {
            display: block;
        }

        .score {
            font-size: 48px;
            font-weight: bold;
            margin: 20px 0;
        }

        .feedback {
            font-size: 18px;
            margin: 15px 0;
        }

        .explanation {
            margin-top: 15px;
            padding: 15px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            font-size: 14px;
            text-align: left;
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            display: none;
            animation: slideIn 0.3s ease;
            z-index: 1000;
        }

        .toast.show {
            display: block;
        }

        .hidden {
            display: none;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @media (max-width: 600px) {
            .button-container {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }

            .quiz-buttons {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="toast" id="toast">Results copied to clipboard!</div>
    
    <div class="container">
        <div class="header">
            <h1 id="quizTitle">ENGLISH HOME LANGUAGE</h1>
            <p id="quizSubtitle">Select a quiz to begin</p>
            <div class="timer-display hidden" id="timerDisplay">‚è±Ô∏è 00:00:00</div>
        </div>

        <div class="content">
            <div class="quiz-selector" id="quizSelector">
                <label>Choose a Quiz:</label>
                <div class="quiz-buttons" id="quizButtons"></div>
            </div>

            <div class="name-input-section hidden" id="nameSection">
                <label for="studentName">Enter Your Name:</label>
                <input type="text" id="studentName" placeholder="Your full name" autocomplete="name">
            </div>

            <div id="quizForm"></div>

            <div class="button-container hidden" id="actionButtons">
                <button type="button" class="submit-btn" onclick="submitQuiz()">Submit Quiz</button>
                <button type="button" class="reset-btn" onclick="resetQuiz()">Reset</button>
                <button type="button" class="copy-btn" id="copyBtn" onclick="copyResults()" disabled>Copy Results</button>
            </div>

            <div class="results" id="results">
                <h2>Quiz Results: COPY & SEND TO TEACHER</h2>
                <div class="score" id="scoreDisplay"></div>
                <div class="feedback" id="feedback"></div>
                <div class="explanation" id="explanation"></div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // ADD YOUR QUIZZES HERE
        // ============================================
        // Each quiz should have a title and the MCQ text
        // 
        // FOR TEXT QUESTIONS: Add [FEEDBACK] on the next line after the question
        // This feedback will show to students when they submit
        //
        // Format:
        // "5. [TEXT] Your question here?
        // [FEEDBACK] Sample answer or key points students should consider."
        
        const allQuizzes = [
            {
                title: "THE CRUCIBLES: ACT 1 9.11.25 QUIZ: 1    ",
                subtitle: "9.11.25",
                mcqText: `
Grade 12 English Literature ‚Äì The Crucible (Act 1) (30 MCQs)

1. Where does Act 1 of *The Crucible* take place?
A) In a church
B) In a forest
C) **In Reverend Parris‚Äôs house**
D) In the town hall
E) In a courtroom

2. Who is Reverend Parris‚Äôs daughter?
A) **Betty**
B) Mary
C) Ruth
D) Abigail
E) Elizabeth

3. Why is Reverend Parris worried at the beginning of the play?
A) His daughter has gone missing
B) His wife is ill
C) **His daughter Betty is unconscious**
D) His church was burned
E) None of the above

4. What did Reverend Parris see the girls doing in the forest?
A) Picking flowers
B) Dancing and singing
C) **Dancing and conjuring spirits**
D) Reading the Bible
E) None of the above

5. Who is Abigail Williams?
A) A servant in Reverend Hale‚Äôs home
B) **Reverend Parris‚Äôs niece**
C) Reverend Parris‚Äôs daughter
D) A farmer‚Äôs wife
E) None of the above

6. Why was Abigail dismissed from the Proctor household?
A) She stole money
B) **She had an affair with John Proctor**
C) She was lazy
D) She was sick
E) None of the above

7. Who is Tituba?
A) A doctor‚Äôs wife
B) A local farmer
C) **Parris‚Äôs slave from Barbados**
D) Abigail‚Äôs sister
E) A judge

8. What kind of play is *The Crucible*?
A) Comedy
B) Romance
C) Tragedy
D) **Historical drama**
E) Science fiction

9. Who asks Reverend Parris to send for Reverend Hale?
A) **Reverend Parris himself**
B) Abigail
C) Mr. Putnam
D) Mrs. Putnam
E) None of the above

10. Why is Mrs. Putnam upset?
A) Her husband was accused of witchcraft
B) **She has lost seven of her babies**
C) Her daughter was arrested
D) She was banished from town
E) None of the above

11. Who is the Putnams‚Äô only surviving child?
A) Betty
B) **Ruth**
C) Abigail
D) Mary
E) None of the above

12. What does Abigail threaten to do to the other girls if they tell the truth?
A) Tell Parris everything
B) Leave Salem
C) **Kill them in their sleep**
D) Expose Tituba
E) None of the above

13. Who is the first person accused of witchcraft in Act 1?
A) Sarah Good
B) **Tituba**
C) Abigail Williams
D) Betty Parris
E) None of the above

14. How does Tituba react to being accused?
A) She runs away
B) **She confesses to save herself**
C) She denies and stays silent
D) She faints
E) None of the above

15. What does Abigail do after Tituba confesses?
A) Leaves Salem
B) **Accuses more townspeople**
C) Begs for forgiveness
D) Confesses her sins
E) None of the above

16. What is the main conflict in Act 1?
A) The Proctors‚Äô marriage problems
B) **Fear of witchcraft spreading through Salem**
C) Disagreements over land
D) A political rivalry
E) None of the above

17. What does Reverend Hale bring with him from Beverly?
A) **Books about witchcraft**
B) Court documents
C) Holy water
D) Bibles
E) None of the above

18. What is John Proctor‚Äôs attitude toward Reverend Parris?
A) He admires him
B) He fears him
C) **He dislikes his greed and hypocrisy**
D) He avoids him out of guilt
E) None of the above

19. What does Rebecca Nurse think is wrong with the children?
A) Witchcraft
B) Poison
C) **A childish stage or mischief**
D) Illness caused by food
E) None of the above

20. Who does Abigail claim sent her spirit out to hurt her?
A) Elizabeth Proctor
B) **Goody Good and Goody Osburn**
C) Mary Warren
D) Rebecca Nurse
E) None of the above

21. What is Parris most worried about when the witchcraft rumors start?
A) Losing his home
B) His daughter‚Äôs health
C) **His reputation and position**
D) Abigail‚Äôs safety
E) None of the above

22. What motivates Thomas Putnam‚Äôs actions in Act 1?
A) Love for his wife
B) Religious faith
C) **Greed and resentment**
D) Friendship with Parris
E) None of the above

23. What is the setting of Salem like according to Miller‚Äôs introduction?
A) A peaceful coastal town
B) **A strict, theocratic Puritan settlement**
C) A wealthy trade city
D) A forest village
E) None of the above

24. What best describes Abigail‚Äôs personality?
A) Honest and shy
B) **Manipulative and vengeful**
C) Loyal and kind
D) Quiet and forgiving
E) None of the above

25. Who tries to calm the situation by saying the children will wake when ready?
A) Abigail
B) **Rebecca Nurse**
C) Elizabeth Proctor
D) Giles Corey
E) None of the above

26. What does Giles Corey say about his wife, Martha?
A) She is a witch
B) **She reads strange books**
C) She is ill
D) She speaks in tongues
E) None of the above

27. What is the main theme introduced in Act 1?
A) **Mass hysteria and fear of the unknown**
B) War and politics
C) Romance and betrayal
D) Hope and forgiveness
E) None of the above

28. Who is the author of *The Crucible*?
A) Tennessee Williams
B) William Shakespeare
C) **Arthur Miller**
D) Lorraine Hansberry
E) None of the above

29. What historical event inspired *The Crucible*?
A) The Great Depression
B) World War II
C) **The Salem Witch Trials**
D) The American Revolution
E) None of the above

30. At the end of Act 1, what happens that sets the hysteria in motion?
A) Parris leaves Salem
B) The girls leave town
C) **The girls begin shouting out names of those they ‚Äúsaw with the devil‚Äù**
D) Hale quits his job
E) None of the above
   `
            },
            {
                title: "LIFE OF PI: 9.11.25: ESSAY Q1",
                subtitle: "In Life of Pi, Yann Martel shows how traumatic experiences can strengthen ones character.",
                mcqText: `

                Grade 12 English Literature ‚Äì Life of Pi (Essay-based MCQs)

1. What lesson does Pi‚Äôs father teach him as a child?
A) The importance of family
B) **The danger of wild animals**
C) The value of religion
D) The need for courage
E) None of the above

2. What animal kills the goat in front of Pi?
A) A lion
B) **A tiger named Mahisha**
C) A leopard
D) A hyena
E) None of the above

3. How does the lesson with Mahisha shape Pi‚Äôs understanding of animals?
A) He becomes afraid of all animals
B) **He learns to respect their danger and instincts**
C) He stops visiting the zoo
D) He decides to become a zookeeper
E) None of the above

4. What does Pi‚Äôs vegetarianism symbolize in the novel?
A) His hatred for his father
B) His rebellion
C) **His compassion and gentle nature**
D) His weakness
E) None of the above

5. How does Pi respond to being teased at St Joseph‚Äôs school?
A) He fights back
B) He runs away
C) **He renames himself ‚ÄúPi‚Äù to stop the teasing**
D) He changes schools
E) None of the above

6. What does Pi‚Äôs decision to rename himself show about his character?
A) He is proud and stubborn
B) **He is creative and resilient**
C) He gives up easily
D) He rejects his culture
E) None of the above

7. What tragic event changes Pi‚Äôs life forever?
A) Losing his faith
B) **The sinking of the ship and the death of his family**
C) Being abandoned by his friends
D) The death of Richard Parker
E) None of the above

8. What helps Pi cope with grief after losing his family?
A) His anger
B) His survival skills
C) **His strong religious faith**
D) His hatred for the sea
E) None of the above

9. What is the name of the tiger stranded with Pi?
A) Mahisha
B) Shere Khan
C) **Richard Parker**
D) Orange Juice
E) None of the above

10. What motivates Pi to keep Richard Parker alive?
A) Pity
B) **The need for companionship and purpose**
C) Fear of being alone
D) Curiosity
E) None of the above

11. What does the killing of the zebra and orangutan represent?
A) The loss of hope
B) **The brutality of nature and survival**
C) The beginning of friendship
D) The end of Pi‚Äôs faith
E) None of the above

12. How does Pi manage to survive on the lifeboat with Richard Parker?
A) He starves himself
B) He prays constantly
C) **He establishes boundaries and dominance**
D) He avoids the tiger
E) None of the above

13. Why is the cook‚Äôs killing of the sailor and Pi‚Äôs mother significant?
A) It reveals the cruelty of humans
B) It shows Pi‚Äôs weakness
C) **It triggers Pi‚Äôs transformation into a survivor**
D) It ends Pi‚Äôs faith
E) None of the above

14. What act marks Pi‚Äôs lowest moral point?
A) Killing a turtle
B) **Eating human flesh**
C) Fighting Richard Parker
D) Killing a bird
E) None of the above

15. What does Pi learn from killing the cook?
A) He enjoys violence
B) **Survival sometimes requires moral compromise**
C) Revenge brings peace
D) Violence solves problems
E) None of the above

16. How does Pi‚Äôs relationship with Richard Parker change over time?
A) He becomes afraid of him
B) He abandons him
C) **He accepts him as a companion and alter ego**
D) He defeats him
E) None of the above

17. What does Richard Parker symbolize in the novel?
A) Pi‚Äôs father
B) **Pi‚Äôs animalistic and survival instincts**
C) God
D) Nature‚Äôs cruelty
E) None of the above

18. What is Pi‚Äôs main emotional struggle throughout his journey?
A) Loneliness
B) **The battle between morality and survival**
C) Anger toward his father
D) Hatred for animals
E) None of the above

19. Why is Pi devastated when the ship fails to rescue him?
A) He is tired of the sea
B) **He loses hope but stays strong for Richard Parker**
C) He blames himself
D) He loses his faith completely
E) None of the above

20. What keeps Pi motivated even during despair?
A) Hunger
B) **Responsibility for Richard Parker**
C) Desire for revenge
D) His hatred of the ocean
E) None of the above

21. What lesson does Pi learn from the algae island?
A) It is safe to settle anywhere
B) Nature is kind
C) **Comfort can be deceptive and dangerous**
D) Richard Parker is harmless
E) None of the above

22. What is symbolized by the human teeth inside the fruit?
A) Hope for survival
B) **Death and the illusion of safety**
C) Discovery of civilization
D) The end of Pi‚Äôs faith
E) None of the above

23. Why does Pi choose to leave the island?
A) He misses his family
B) He fears loneliness
C) **He realises staying means certain death**
D) He wants to find God
E) None of the above

24. What does Richard Parker‚Äôs final departure represent?
A) Betrayal
B) **The end of Pi‚Äôs animal nature**
C) The return of fear
D) The end of faith
E) None of the above

25. How does Pi‚Äôs faith influence his survival?
A) It makes him give up food
B) It makes him hallucinate
C) **It gives him hope and purpose**
D) It leads to his suffering
E) None of the above

26. What does Pi learn about human nature by the end of the novel?
A) People are always kind
B) **Humans have both savage and spiritual sides**
C) Humans are superior to animals
D) Only faith matters
E) None of the above

27. Which emotion best describes Pi‚Äôs journey?
A) Anger
B) Joy
C) **Fear mixed with faith**
D) Hatred
E) Confusion

28. What is the effect of Pi‚Äôs storytelling on the readers?
A) It confuses them
B) It hides the truth
C) **It makes them question what is real**
D) It simplifies the story
E) None of the above

29. What can Pi‚Äôs story be seen as an allegory for?
A) A child‚Äôs imagination
B) A science experiment
C) **The struggle between faith and reason**
D) The power of money
E) None of the above

30. What overall message does *Life of Pi* convey?
A) Life is meaningless
B) Faith is unnecessary
C) **Human beings can survive unimaginable hardship through faith, reason, and willpower**
D) Nature is kind
E) None of the above

   `
            },
            {
                title: "",
                subtitle: "",
                mcqText: `
      `
            },
            {
                title: "",
                subtitle: "",
                mcqText: `
Your Custom Quiz

1. Sample question 1?
A) Option A
B) **Correct Answer**
C) Option C
D) Option D

2. [TEXT] Write your thoughts here.
[FEEDBACK] This is a sample answer or key points you want students to consider when answering this question.

[IMAGE: 1.png]
3. Sample question 2?
A) Wrong
B) Wrong
C) **Right**
D) Wrong
                `
            }


        ];
        
        // ============================================
        // END OF QUIZZES - DON'T EDIT BELOW THIS LINE
        // ============================================

        let currentQuizIndex = null;
        let quizResults = null;
        let quizData = [];
        let timerInterval = null;
        let startTime = null;
        let elapsedSeconds = 0;

        function initializeApp() {
            const quizButtons = document.getElementById('quizButtons');
            quizButtons.innerHTML = '';
            
            allQuizzes.forEach((quiz, index) => {
                const btn = document.createElement('button');
                btn.className = 'quiz-btn';
                btn.textContent = quiz.title;
                btn.onclick = () => selectQuiz(index);
                quizButtons.appendChild(btn);
            });
        }

        function selectQuiz(index) {
            currentQuizIndex = index;
            const selectedQuiz = allQuizzes[index];
            
            // Update header
            document.getElementById('quizTitle').textContent = selectedQuiz.title;
            document.getElementById('quizSubtitle').textContent = selectedQuiz.subtitle;
            
            // Show name section and action buttons
            document.getElementById('nameSection').classList.remove('hidden');
            document.getElementById('actionButtons').classList.remove('hidden');
            document.getElementById('timerDisplay').classList.remove('hidden');
            
            // Highlight selected button
            const buttons = document.querySelectorAll('.quiz-btn');
            buttons.forEach((btn, i) => {
                if (i === index) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // Generate quiz
            generateQuiz(selectedQuiz.mcqText);
        }

        function startTimer() {
            startTime = Date.now();
            timerInterval = setInterval(updateTimer, 1000);
        }

        function updateTimer() {
            const now = Date.now();
            elapsedSeconds = Math.floor((now - startTime) / 1000);
            
            const hours = Math.floor(elapsedSeconds / 3600);
            const minutes = Math.floor((elapsedSeconds % 3600) / 60);
            const seconds = elapsedSeconds % 60;
            
            const timeString = `‚è±Ô∏è ${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            document.getElementById('timerDisplay').textContent = timeString;
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }

        function formatElapsedTime(seconds) {
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = seconds % 60;
            
            if (hours > 0) {
                return `${hours}h ${minutes}m ${secs}s`;
            } else if (minutes > 0) {
                return `${minutes}m ${secs}s`;
            } else {
                return `${secs}s`;
            }
        }

        function parseMCQText(text) {
            const questions = [];
            const lines = text.trim().split('\n').filter(line => line.trim());
            
            let currentQuestion = null;
            let currentOptions = [];
            let correctIndex = -1;
            let optionCount = 0;
            let titleLine = '';
            let currentImage = null;
            let isTextQuestion = false;
            let currentFeedback = null;
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                
                if (i === 0 && !line.match(/^\d+\./)) {
                    titleLine = line;
                    continue;
                }
                
                const imageMatch = line.match(/^\[IMAGE:\s*(.+)\]$/i);
                if (imageMatch) {
                    currentImage = imageMatch[1].trim();
                    continue;
                }
                
                const questionMatch = line.match(/^(\d+)\.\s*(.+)/);
                if (questionMatch) {
                    if (currentQuestion && (currentOptions.length > 0 || isTextQuestion)) {
                        questions.push({
                            question: currentQuestion,
                            options: isTextQuestion ? [] : currentOptions,
                            correct: correctIndex,
                            image: null,
                            isText: isTextQuestion,
                            feedback: currentFeedback
                        });
                    }
                    
                    const questionText = questionMatch[2];
                    const textMatch = questionText.match(/^\[TEXT\]\s*(.+)/i);
                    
                    if (textMatch) {
                        currentQuestion = textMatch[1];
                        currentOptions = [];
                        correctIndex = -1;
                        optionCount = 0;
                        isTextQuestion = true;
                        currentFeedback = null;
                    } else {
                        currentQuestion = questionText;
                        currentOptions = [];
                        correctIndex = -1;
                        optionCount = 0;
                        isTextQuestion = false;
                        currentFeedback = null;
                    }
                    continue;
                }
                
                // Check for feedback line
                const feedbackMatch = line.match(/^\[FEEDBACK\]\s*(.+)/i);
                if (feedbackMatch) {
                    currentFeedback = feedbackMatch[1];
                    continue;
                }
                
                if (!isTextQuestion) {
                    const optionMatch = line.match(/^([A-Za-z])\)\s*(.+)/);
                    if (optionMatch && currentQuestion) {
                        let optionText = optionMatch[2];
                        
                        const isBold = optionText.includes('**') || optionText.includes('***');
                        const isUppercase = optionText === optionText.toUpperCase() && 
                                           optionText !== optionText.toLowerCase() &&
                                           !optionText.includes('**');
                        const hasCorrectMarker = optionText.toUpperCase().includes('[CORRECT]') || 
                                                optionText.toUpperCase().includes('(CORRECT)');
                        
                        if (isBold || hasCorrectMarker) {
                            correctIndex = optionCount;
                            optionText = optionText.replace(/\*\*/g, '').replace(/\*\*\*/g, '')
                                                  .replace(/\[CORRECT\]/gi, '').replace(/\(CORRECT\)/gi, '').trim();
                        } else if (isUppercase && optionText.length > 3) {
                            correctIndex = optionCount;
                        }
                        
                        currentOptions.push(optionText);
                        optionCount++;
                    }
                }
            }
            
            if (currentQuestion && (currentOptions.length > 0 || isTextQuestion)) {
                questions.push({
                    question: currentQuestion,
                    options: currentOptions,
                    correct: correctIndex,
                    image: currentImage,
                    isText: isTextQuestion
                });
            }
            
            let pendingImage = null;
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                const imageMatch = line.match(/^\[IMAGE:\s*(.+)\]$/i);
                
                if (imageMatch) {
                    pendingImage = imageMatch[1].trim();
                } else if (line.match(/^\d+\.\s*(.+)/)) {
                    const questionMatch = line.match(/^\d+\.\s*(.+)/);
                    let qText = questionMatch[1];
                    
                    const textMatch = qText.match(/^\[TEXT\]\s*(.+)/i);
                    if (textMatch) {
                        qText = textMatch[1];
                    }
                    
                    const foundQ = questions.find(q => q.question === qText);
                    if (foundQ && pendingImage) {
                        foundQ.image = pendingImage;
                        pendingImage = null;
                    }
                }
            }
            
            return { title: titleLine, questions: questions };
        }

        function generateQuiz(mcqText) {
            const parsed = parseMCQText(mcqText);
            quizData = parsed.questions;
            
            const quizForm = document.getElementById('quizForm');
            let html = '';

            quizData.forEach((q, index) => {
                const qNum = index + 1;
                const qId = `q${qNum}`;
                
                html += `
                    <div class="question-container">
                        <div class="question-number">Question ${qNum} of ${quizData.length}</div>`;
                
                if (q.image) {
                    html += `<img src="${q.image}" alt="Question ${qNum} image" class="question-image" onerror="this.style.display='none'">`;
                }
                
                html += `<div class="question">${q.question}</div>`;
                
                if (q.isText) {
                    html += `
                        <label class="text-answer-label" for="${qId}_text">Your Answer:</label>
                        <textarea class="text-input" id="${qId}_text" name="${qId}" placeholder="Type your answer here..."></textarea>
                        <div class="text-feedback" id="${qId}_feedback"></div>`;
                } else {
                    html += `<div class="options">`;
                    
                    q.options.forEach((option, optIndex) => {
                        const optId = `${qId}_${optIndex}`;
                        html += `
                            <div class="option" onclick="selectOption(this, '${qId}', ${optIndex})">
                                <input type="radio" name="${qId}" value="${optIndex}" id="${optId}">
                                <label for="${optId}">${option}</label>
                            </div>`;
                    });
                    
                    html += `</div>`;
                }
                
                html += `</div>`;
            });

            quizForm.innerHTML = html;
            
            stopTimer();
            elapsedSeconds = 0;
            startTimer();
            
            document.getElementById('results').classList.remove('show');
            document.getElementById('copyBtn').disabled = true;
        }

        function selectOption(element, questionName, value) {
            const radio = document.getElementById(`${questionName}_${value}`);
            radio.checked = true;
        }

        function submitQuiz() {
            if (currentQuizIndex === null) {
                alert('Please select a quiz first.');
                return;
            }

            const studentName = document.getElementById('studentName').value.trim();
            
            if (!studentName) {
                alert('Please enter your name before submitting.');
                document.getElementById('studentName').focus();
                return;
            }

            stopTimer();
            const timeTaken = elapsedSeconds;

            let score = 0;
            let totalQuestions = quizData.length;
            let detailedResults = [];

            quizData.forEach((q, index) => {
                const qNum = index + 1;
                const qId = `q${qNum}`;
                
                if (q.isText) {
                    const textInput = document.getElementById(`${qId}_text`);
                    const textAnswer = textInput ? textInput.value.trim() : '';
                    
                    // Show feedback if available
                    if (q.feedback) {
                        const feedbackDiv = document.getElementById(`${qId}_feedback`);
                        if (feedbackDiv) {
                            feedbackDiv.innerHTML = `<h4>üí° Sample Answer / Points to Consider:</h4><p>${q.feedback}</p>`;
                            feedbackDiv.classList.add('show');
                        }
                    }
                    
                    detailedResults.push({
                        question: q.question,
                        answer: textAnswer || "No answer provided",
                        feedback: q.feedback || null,
                        isText: true
                    });
                } else {
                    const selectedOption = document.querySelector(`input[name="${qId}"]:checked`);
                    const options = document.querySelectorAll(`input[name="${qId}"]`);
                    
                    if (selectedOption) {
                        const selectedIndex = parseInt(selectedOption.value);
                        const isCorrect = selectedIndex === q.correct;
                        
                        if (isCorrect) {
                            score++;
                            selectedOption.parentElement.classList.add('correct');
                        } else {
                            selectedOption.parentElement.classList.add('incorrect');
                        }
                        
                        options.forEach((opt, optIndex) => {
                            if (optIndex === q.correct) {
                                opt.parentElement.classList.add('correct');
                            }
                        });

                        detailedResults.push({
                            question: q.question,
                            selected: q.options[selectedIndex],
                            correct: q.options[q.correct],
                            isCorrect: isCorrect,
                            isText: false
                        });
                    } else {
                        options.forEach((opt, optIndex) => {
                            if (optIndex === q.correct) {
                                opt.parentElement.classList.add('correct');
                            }
                        });

                        detailedResults.push({
                            question: q.question,
                            selected: "No answer provided",
                            correct: q.options[q.correct],
                            isCorrect: false,
                            isText: false
                        });
                    }
                }
            });

            const mcqCount = quizData.filter(q => !q.isText).length;
            const percentage = mcqCount > 0 ? Math.round((score / mcqCount) * 100) : 0;

            const resultsDiv = document.getElementById('results');
            const scoreDisplay = document.getElementById('scoreDisplay');
            const feedback = document.getElementById('feedback');
            const explanation = document.getElementById('explanation');

            scoreDisplay.textContent = `${score} / ${mcqCount}`;
            
            let feedbackText = '';
            if (percentage >= 90) {
                feedbackText = 'üéâ Outstanding! Excellent work!';
            } else if (percentage >= 75) {
                feedbackText = 'üëè Great job! Strong understanding!';
            } else if (percentage >= 60) {
                feedbackText = 'üëç Good effort! Keep studying!';
            } else {
                feedbackText = 'üìö Keep practicing! Review and try again.';
            }
            
            feedback.textContent = feedbackText;
            
            const textQCount = quizData.filter(q => q.isText).length;
            let explanationText = `<strong>Your Score: ${percentage}%</strong><br>You answered ${score} out of ${mcqCount} multiple choice questions correctly.`;
            if (textQCount > 0) {
                explanationText += `<br>${textQCount} text question(s) included (not scored).`;
            }
            explanationText += `<br><strong>Time Taken: ${formatElapsedTime(timeTaken)}</strong>`;
            explanation.innerHTML = explanationText;

            resultsDiv.classList.add('show');
            
            quizResults = {
                quizTitle: allQuizzes[currentQuizIndex].title,
                name: studentName,
                score: score,
                total: mcqCount,
                totalQuestions: totalQuestions,
                percentage: percentage,
                timeTaken: timeTaken,
                timeFormatted: formatElapsedTime(timeTaken),
                details: detailedResults
            };

            document.getElementById('copyBtn').disabled = false;

            const inputs = document.querySelectorAll('input[type="radio"], textarea');
            inputs.forEach(input => input.disabled = true);
            document.getElementById('studentName').disabled = true;

            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function resetQuiz() {
            if (currentQuizIndex === null) return;
            
            stopTimer();
            elapsedSeconds = 0;
            document.getElementById('timerDisplay').textContent = '‚è±Ô∏è 00:00:00';
            
            const inputs = document.querySelectorAll('input[type="radio"]');
            inputs.forEach(input => {
                input.checked = false;
                input.disabled = false;
            });
            
            const textInputs = document.querySelectorAll('textarea');
            textInputs.forEach(input => {
                input.value = '';
                input.disabled = false;
            });
            
            const options = document.querySelectorAll('.option');
            options.forEach(opt => {
                opt.classList.remove('correct', 'incorrect');
            });

            document.getElementById('results').classList.remove('show');
            document.getElementById('studentName').disabled = false;
            document.getElementById('copyBtn').disabled = true;
            quizResults = null;

            startTimer();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function copyResults() {
            if (!quizResults) return;
            
            let resultText = `üìù ${quizResults.quizTitle.toUpperCase()} - RESULTS\n`;
            resultText += `================================\n\n`;
            resultText += `Student Name: ${quizResults.name}\n`;
            resultText += `Score: ${quizResults.score}/${quizResults.total} MCQs (${quizResults.percentage}%)\n`;
            resultText += `Total Questions: ${quizResults.totalQuestions}\n`;
            resultText += `Time Taken: ${quizResults.timeFormatted}\n`;
            resultText += `Date: ${new Date().toLocaleString()}\n\n`;
            resultText += `DETAILED ANSWERS:\n`;
            resultText += `================================\n\n`;

            quizResults.details.forEach((result, index) => {
                resultText += `Question ${index + 1}: ${result.question}\n`;
                if (result.isText) {
                    resultText += `Answer: ${result.answer}\n`;
                    if (result.feedback) {
                        resultText += `Sample Answer/Points: ${result.feedback}\n`;
                    }
                    resultText += `\n`;
                } else {
                    resultText += `Your answer: ${result.selected}\n`;
                    resultText += `Correct answer: ${result.correct}\n`;
                    resultText += `Status: ${result.isCorrect ? '‚úì Correct' : '‚úó Incorrect'}\n\n`;
                }
            });

            resultText += `================================\n`;

            navigator.clipboard.writeText(resultText).then(() => {
                const toast = document.getElementById('toast');
                toast.classList.add('show');
                setTimeout(() => {
                    toast.classList.remove('show');
                }, 3000);
            }).catch(err => {
                alert('Failed to copy results. Please try again.');
                console.error('Copy failed:', err);
            });
        }

        // Initialize the app on page load
        initializeApp();
    </script>
</body>
</html>
